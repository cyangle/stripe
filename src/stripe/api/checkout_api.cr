#  Stripe API
#
# The Stripe REST API. Please see https://stripe.com/docs/api for more details.
#
# The version of the OpenAPI document: 2024-06-20
# Contact: dev-platform@stripe.com
# Generated by: https://openapi-generator.tech
#

require "../../core"

require "../models/after_expiration_params"
require "../models/automatic_tax_params"
require "../models/checkout_session"
require "../models/consent_collection_params"
require "../models/custom_field_param"
require "../models/custom_text_param"
require "../models/customer_details_params"
require "../models/customer_update_params"
require "../models/discount_params"
require "../models/error"
require "../models/get_accounts_created_parameter"

require "../models/invoice_creation_params"
require "../models/line_item_params"
require "../models/payment_intent_data_params"
require "../models/payment_method_data_param"
require "../models/payment_method_options_param"
require "../models/payment_pages_checkout_session_list"
require "../models/payment_pages_checkout_session_list_line_items"
require "../models/phone_number_collection_params"
require "../models/post_accounts_request_metadata"
require "../models/saved_payment_method_options_param"
require "../models/setup_intent_data_param"
require "../models/shipping_address_collection_params"
require "../models/shipping_option_params"
require "../models/subscription_data_params"
require "../models/tax_id_collection_params"

module Stripe
  class CheckoutApi
    property api_client : ApiClient

    delegate client_side_validation?, debugging?, to: @api_client.config

    def initialize(api_client = ApiClient.default)
      @api_client = api_client
    end

    # <p>Returns a list of Checkout Sessions.</p>
    # @optional @param ending_before [String?] A cursor for use in pagination. `ending_before` is an object ID that defines your place in the list. For instance, if you make a list request and receive 100 objects, starting with `obj_bar`, your subsequent call can include `ending_before=obj_bar` in order to fetch the previous page of the list.
    # @optional @param starting_after [String?] A cursor for use in pagination. `starting_after` is an object ID that defines your place in the list. For instance, if you make a list request and receive 100 objects, ending with `obj_foo`, your subsequent call can include `starting_after=obj_foo` in order to fetch the next page of the list.
    # @optional @param limit [Int32?] A limit on the number of objects to be returned. Limit can range between 1 and 100, and the default is 10.
    # @optional @param created [Stripe::GetAccountsCreatedParameter?] Only return Checkout Sessions that were created during the given date interval.
    # @optional @param payment_intent [String?] Only return the Checkout Session for the PaymentIntent specified.
    # @optional @param subscription [String?] Only return the Checkout Session for the subscription specified.
    # @optional @param customer_details [Stripe::CustomerDetailsParams?] Only return the Checkout Sessions for the Customer details specified.
    # @optional @param customer [String?] Only return the Checkout Sessions for the Customer specified.
    # @optional @param payment_link [String?] Only return the Checkout Sessions for the Payment Link specified.
    # @optional @param status [String?] Only return the Checkout Sessions matching the given status.
    # @optional @param expand [Array(Array(String))?] Specifies which fields in the response should be expanded.
    # @return [Stripe::PaymentPagesCheckoutSessionList]
    def get_checkout_sessions(
      *,
      ending_before : String? = nil,
      starting_after : String? = nil,
      limit : Int64? = nil,
      created : Stripe::GetAccountsCreatedParameter? = nil,
      payment_intent : String? = nil,
      subscription : String? = nil,
      customer_details : Stripe::CustomerDetailsParams? = nil,
      customer : String? = nil,
      payment_link : String? = nil,
      status : String? = nil,
      expand : Array(Array(String))? = nil
    ) : Stripe::PaymentPagesCheckoutSessionList
      data, _status_code, _headers = get_checkout_sessions_with_http_info(ending_before: ending_before, starting_after: starting_after, limit: limit, created: created, payment_intent: payment_intent, subscription: subscription, customer_details: customer_details, customer: customer, payment_link: payment_link, status: status, expand: expand)
      data
    end

    # &lt;p&gt;Returns a list of Checkout Sessions.&lt;/p&gt;
    # @optional @param ending_before [String?] A cursor for use in pagination. `ending_before` is an object ID that defines your place in the list. For instance, if you make a list request and receive 100 objects, starting with `obj_bar`, your subsequent call can include `ending_before=obj_bar` in order to fetch the previous page of the list.
    # @optional @param starting_after [String?] A cursor for use in pagination. `starting_after` is an object ID that defines your place in the list. For instance, if you make a list request and receive 100 objects, ending with `obj_foo`, your subsequent call can include `starting_after=obj_foo` in order to fetch the next page of the list.
    # @optional @param limit [Int32?] A limit on the number of objects to be returned. Limit can range between 1 and 100, and the default is 10.
    # @optional @param created [Stripe::GetAccountsCreatedParameter?] Only return Checkout Sessions that were created during the given date interval.
    # @optional @param payment_intent [String?] Only return the Checkout Session for the PaymentIntent specified.
    # @optional @param subscription [String?] Only return the Checkout Session for the subscription specified.
    # @optional @param customer_details [Stripe::CustomerDetailsParams?] Only return the Checkout Sessions for the Customer details specified.
    # @optional @param customer [String?] Only return the Checkout Sessions for the Customer specified.
    # @optional @param payment_link [String?] Only return the Checkout Sessions for the Payment Link specified.
    # @optional @param status [String?] Only return the Checkout Sessions matching the given status.
    # @optional @param expand [Array(Array(String))?] Specifies which fields in the response should be expanded.
    # @return [Tuple(Stripe::PaymentPagesCheckoutSessionList, Integer, Hash)] Stripe::PaymentPagesCheckoutSessionList, response status code and response headers
    def get_checkout_sessions_with_http_info(
      *,
      ending_before : String? = nil,
      starting_after : String? = nil,
      limit : Int64? = nil,
      created : Stripe::GetAccountsCreatedParameter? = nil,
      payment_intent : String? = nil,
      subscription : String? = nil,
      customer_details : Stripe::CustomerDetailsParams? = nil,
      customer : String? = nil,
      payment_link : String? = nil,
      status : String? = nil,
      expand : Array(Array(String))? = nil
    ) : Tuple(Stripe::PaymentPagesCheckoutSessionList, Int32, Hash(String, Array(String) | String))
      request = build_api_request_for_get_checkout_sessions(ending_before: ending_before, starting_after: starting_after, limit: limit, created: created, payment_intent: payment_intent, subscription: subscription, customer_details: customer_details, customer: customer, payment_link: payment_link, status: status, expand: expand)

      body, status_code, headers = @api_client.execute_api_request(request)

      if debugging?
        Log.debug { "API called: CheckoutApi#get_checkout_sessions\nBody: #{body.inspect}\nStatus code: #{status_code}\nHeaders: #{headers}" }
      end

      Tuple.new(Stripe::PaymentPagesCheckoutSessionList.from_json(body), status_code, headers)
    end

    # &lt;p&gt;Returns a list of Checkout Sessions.&lt;/p&gt;
    # @optional @param ending_before [String?] A cursor for use in pagination. `ending_before` is an object ID that defines your place in the list. For instance, if you make a list request and receive 100 objects, starting with `obj_bar`, your subsequent call can include `ending_before=obj_bar` in order to fetch the previous page of the list.
    # @optional @param starting_after [String?] A cursor for use in pagination. `starting_after` is an object ID that defines your place in the list. For instance, if you make a list request and receive 100 objects, ending with `obj_foo`, your subsequent call can include `starting_after=obj_foo` in order to fetch the next page of the list.
    # @optional @param limit [Int32?] A limit on the number of objects to be returned. Limit can range between 1 and 100, and the default is 10.
    # @optional @param created [Stripe::GetAccountsCreatedParameter?] Only return Checkout Sessions that were created during the given date interval.
    # @optional @param payment_intent [String?] Only return the Checkout Session for the PaymentIntent specified.
    # @optional @param subscription [String?] Only return the Checkout Session for the subscription specified.
    # @optional @param customer_details [Stripe::CustomerDetailsParams?] Only return the Checkout Sessions for the Customer details specified.
    # @optional @param customer [String?] Only return the Checkout Sessions for the Customer specified.
    # @optional @param payment_link [String?] Only return the Checkout Sessions for the Payment Link specified.
    # @optional @param status [String?] Only return the Checkout Sessions matching the given status.
    # @optional @param expand [Array(Array(String))?] Specifies which fields in the response should be expanded.
    # @return nil
    def get_checkout_sessions(
      *,
      ending_before : String? = nil,
      starting_after : String? = nil,
      limit : Int64? = nil,
      created : Stripe::GetAccountsCreatedParameter? = nil,
      payment_intent : String? = nil,
      subscription : String? = nil,
      customer_details : Stripe::CustomerDetailsParams? = nil,
      customer : String? = nil,
      payment_link : String? = nil,
      status : String? = nil,
      expand : Array(Array(String))? = nil,
      &block : Crest::Response ->
    ) : Nil
      build_api_request_for_get_checkout_sessions(ending_before: ending_before, starting_after: starting_after, limit: limit, created: created, payment_intent: payment_intent, subscription: subscription, customer_details: customer_details, customer: customer, payment_link: payment_link, status: status, expand: expand).execute(&block)
    end

    GET_CHECKOUT_SESSIONS_MAX_LENGTH_FOR_ENDING_BEFORE  = 5000
    GET_CHECKOUT_SESSIONS_MAX_LENGTH_FOR_STARTING_AFTER = 5000
    GET_CHECKOUT_SESSIONS_MAX_LENGTH_FOR_PAYMENT_INTENT = 5000
    GET_CHECKOUT_SESSIONS_MAX_LENGTH_FOR_SUBSCRIPTION   = 5000
    GET_CHECKOUT_SESSIONS_MAX_LENGTH_FOR_CUSTOMER       = 5000
    GET_CHECKOUT_SESSIONS_MAX_LENGTH_FOR_PAYMENT_LINK   = 5000
    GET_CHECKOUT_SESSIONS_VALID_VALUES_FOR_STATUS       = String.static_array("complete", "expired", "open")

    # @return Crest::Request
    def build_api_request_for_get_checkout_sessions(
      *,
      ending_before : String? = nil,
      starting_after : String? = nil,
      limit : Int64? = nil,
      created : Stripe::GetAccountsCreatedParameter? = nil,
      payment_intent : String? = nil,
      subscription : String? = nil,
      customer_details : Stripe::CustomerDetailsParams? = nil,
      customer : String? = nil,
      payment_link : String? = nil,
      status : String? = nil,
      expand : Array(Array(String))? = nil
    ) : Crest::Request
      if debugging?
        Log.debug { "Calling API: CheckoutApi.get_checkout_sessions ..." }
      end

      if client_side_validation?
        unless (_ending_before = ending_before).nil?
          OpenApi::PrimitiveValidator.validate_max_length("ending_before", ending_before.to_s.size, GET_CHECKOUT_SESSIONS_MAX_LENGTH_FOR_ENDING_BEFORE)
        end
        unless (_starting_after = starting_after).nil?
          OpenApi::PrimitiveValidator.validate_max_length("starting_after", starting_after.to_s.size, GET_CHECKOUT_SESSIONS_MAX_LENGTH_FOR_STARTING_AFTER)
        end

        unless (_created = created).nil?
          _created.validate if _created.is_a?(OpenApi::Validatable)
        end
        unless (_payment_intent = payment_intent).nil?
          OpenApi::PrimitiveValidator.validate_max_length("payment_intent", payment_intent.to_s.size, GET_CHECKOUT_SESSIONS_MAX_LENGTH_FOR_PAYMENT_INTENT)
        end
        unless (_subscription = subscription).nil?
          OpenApi::PrimitiveValidator.validate_max_length("subscription", subscription.to_s.size, GET_CHECKOUT_SESSIONS_MAX_LENGTH_FOR_SUBSCRIPTION)
        end
        unless (_customer_details = customer_details).nil?
          _customer_details.validate if _customer_details.is_a?(OpenApi::Validatable)
        end
        unless (_customer = customer).nil?
          OpenApi::PrimitiveValidator.validate_max_length("customer", customer.to_s.size, GET_CHECKOUT_SESSIONS_MAX_LENGTH_FOR_CUSTOMER)
        end
        unless (_payment_link = payment_link).nil?
          OpenApi::PrimitiveValidator.validate_max_length("payment_link", payment_link.to_s.size, GET_CHECKOUT_SESSIONS_MAX_LENGTH_FOR_PAYMENT_LINK)
        end
        unless (_status = status).nil?
          OpenApi::EnumValidator.validate("status", _status, GET_CHECKOUT_SESSIONS_VALID_VALUES_FOR_STATUS)
        end
      end

      # resource path
      local_var_path = "/v1/checkout/sessions"

      # header parameters
      header_params : Hash(String, String) = Hash(String, String).new
      # HTTP header "Accept" (if needed)
      header_params["Accept"] = @api_client.select_header_accept(["application/json"])

      # cookie parameters
      cookie_params : Hash(String, String) = Hash(String, String).new

      # query parameters
      query_params : Hash(String, (String | Array(String) | JSON::Any)) = Hash(String, (String | Array(String) | JSON::Any)).new
      query_params["ending_before"] = ending_before.to_s if !ending_before.nil?
      query_params["starting_after"] = starting_after.to_s if !starting_after.nil?
      query_params["limit"] = limit.to_s if !limit.nil?
      query_params["created"] = created.to_s if !created.nil?
      query_params["payment_intent"] = payment_intent.to_s if !payment_intent.nil?
      query_params["subscription"] = subscription.to_s if !subscription.nil?
      query_params["customer_details"] = customer_details.to_s if !customer_details.nil?
      query_params["customer"] = customer.to_s if !customer.nil?
      query_params["payment_link"] = payment_link.to_s if !payment_link.nil?
      query_params["status"] = status.to_s if !status.nil?
      query_params["expand"] = @api_client.build_collection_param(expand, "csv") if !expand.nil? && !expand.empty?

      # form parameters
      form_params : Array(Tuple(String, Crest::ParamsValue)) | Nil = nil

      # http body (model)
      post_body : IO | String | Nil = nil

      # auth_names
      auth_names = ["basicAuth", "bearerAuth"]

      @api_client.build_api_request(
        http_method: :"GET",
        path: local_var_path,
        operation: "CheckoutApi.get_checkout_sessions",
        post_body: post_body,
        auth_names: auth_names,
        header_params: header_params,
        cookie_params: cookie_params,
        query_params: query_params,
        form_params: form_params
      )
    end

    # <p>Retrieves a Session object.</p>
    # @required @param session [String?]
    # @optional @param expand [Array(Array(String))?] Specifies which fields in the response should be expanded.
    # @return [Stripe::CheckoutSession]
    def get_checkout_sessions_session(
      *,
      session : String? = nil,
      expand : Array(Array(String))? = nil
    ) : Stripe::CheckoutSession
      data, _status_code, _headers = get_checkout_sessions_session_with_http_info(session: session, expand: expand)
      data
    end

    # &lt;p&gt;Retrieves a Session object.&lt;/p&gt;
    # @required @param session [String?]
    # @optional @param expand [Array(Array(String))?] Specifies which fields in the response should be expanded.
    # @return [Tuple(Stripe::CheckoutSession, Integer, Hash)] Stripe::CheckoutSession, response status code and response headers
    def get_checkout_sessions_session_with_http_info(
      *,
      session : String? = nil,
      expand : Array(Array(String))? = nil
    ) : Tuple(Stripe::CheckoutSession, Int32, Hash(String, Array(String) | String))
      request = build_api_request_for_get_checkout_sessions_session(session: session, expand: expand)

      body, status_code, headers = @api_client.execute_api_request(request)

      if debugging?
        Log.debug { "API called: CheckoutApi#get_checkout_sessions_session\nBody: #{body.inspect}\nStatus code: #{status_code}\nHeaders: #{headers}" }
      end

      Tuple.new(Stripe::CheckoutSession.from_json(body), status_code, headers)
    end

    # &lt;p&gt;Retrieves a Session object.&lt;/p&gt;
    # @required @param session [String?]
    # @optional @param expand [Array(Array(String))?] Specifies which fields in the response should be expanded.
    # @return nil
    def get_checkout_sessions_session(
      *,
      session : String? = nil,
      expand : Array(Array(String))? = nil,
      &block : Crest::Response ->
    ) : Nil
      build_api_request_for_get_checkout_sessions_session(session: session, expand: expand).execute(&block)
    end

    GET_CHECKOUT_SESSIONS_SESSION_MAX_LENGTH_FOR_SESSION = 66

    # @return Crest::Request
    def build_api_request_for_get_checkout_sessions_session(
      *,
      session : String? = nil,
      expand : Array(Array(String))? = nil
    ) : Crest::Request
      if debugging?
        Log.debug { "Calling API: CheckoutApi.get_checkout_sessions_session ..." }
      end

      if client_side_validation?
        raise ArgumentError.new("\"session\" is required and cannot be null") if session.nil?
        unless (_session = session).nil?
          OpenApi::PrimitiveValidator.validate_max_length("session", session.to_s.size, GET_CHECKOUT_SESSIONS_SESSION_MAX_LENGTH_FOR_SESSION)
        end
      end

      # resource path
      local_var_path = "/v1/checkout/sessions/{session}".sub("{" + "session" + "}", URI.encode_path(session.to_s))

      # header parameters
      header_params : Hash(String, String) = Hash(String, String).new
      # HTTP header "Accept" (if needed)
      header_params["Accept"] = @api_client.select_header_accept(["application/json"])

      # cookie parameters
      cookie_params : Hash(String, String) = Hash(String, String).new

      # query parameters
      query_params : Hash(String, (String | Array(String) | JSON::Any)) = Hash(String, (String | Array(String) | JSON::Any)).new
      query_params["expand"] = @api_client.build_collection_param(expand, "csv") if !expand.nil? && !expand.empty?

      # form parameters
      form_params : Array(Tuple(String, Crest::ParamsValue)) | Nil = nil

      # http body (model)
      post_body : IO | String | Nil = nil

      # auth_names
      auth_names = ["basicAuth", "bearerAuth"]

      @api_client.build_api_request(
        http_method: :"GET",
        path: local_var_path,
        operation: "CheckoutApi.get_checkout_sessions_session",
        post_body: post_body,
        auth_names: auth_names,
        header_params: header_params,
        cookie_params: cookie_params,
        query_params: query_params,
        form_params: form_params
      )
    end

    # <p>When retrieving a Checkout Session, there is an includable <strong>line_items</strong> property containing the first handful of those items. There is also a URL where you can retrieve the full (paginated) list of line items.</p>
    # @required @param session [String?]
    # @optional @param ending_before [String?] A cursor for use in pagination. `ending_before` is an object ID that defines your place in the list. For instance, if you make a list request and receive 100 objects, starting with `obj_bar`, your subsequent call can include `ending_before=obj_bar` in order to fetch the previous page of the list.
    # @optional @param starting_after [String?] A cursor for use in pagination. `starting_after` is an object ID that defines your place in the list. For instance, if you make a list request and receive 100 objects, ending with `obj_foo`, your subsequent call can include `starting_after=obj_foo` in order to fetch the next page of the list.
    # @optional @param limit [Int32?] A limit on the number of objects to be returned. Limit can range between 1 and 100, and the default is 10.
    # @optional @param expand [Array(Array(String))?] Specifies which fields in the response should be expanded.
    # @return [Stripe::PaymentPagesCheckoutSessionListLineItems]
    def get_checkout_sessions_session_line_items(
      *,
      session : String? = nil,
      ending_before : String? = nil,
      starting_after : String? = nil,
      limit : Int64? = nil,
      expand : Array(Array(String))? = nil
    ) : Stripe::PaymentPagesCheckoutSessionListLineItems
      data, _status_code, _headers = get_checkout_sessions_session_line_items_with_http_info(session: session, ending_before: ending_before, starting_after: starting_after, limit: limit, expand: expand)
      data
    end

    # &lt;p&gt;When retrieving a Checkout Session, there is an includable &lt;strong&gt;line_items&lt;/strong&gt; property containing the first handful of those items. There is also a URL where you can retrieve the full (paginated) list of line items.&lt;/p&gt;
    # @required @param session [String?]
    # @optional @param ending_before [String?] A cursor for use in pagination. `ending_before` is an object ID that defines your place in the list. For instance, if you make a list request and receive 100 objects, starting with `obj_bar`, your subsequent call can include `ending_before=obj_bar` in order to fetch the previous page of the list.
    # @optional @param starting_after [String?] A cursor for use in pagination. `starting_after` is an object ID that defines your place in the list. For instance, if you make a list request and receive 100 objects, ending with `obj_foo`, your subsequent call can include `starting_after=obj_foo` in order to fetch the next page of the list.
    # @optional @param limit [Int32?] A limit on the number of objects to be returned. Limit can range between 1 and 100, and the default is 10.
    # @optional @param expand [Array(Array(String))?] Specifies which fields in the response should be expanded.
    # @return [Tuple(Stripe::PaymentPagesCheckoutSessionListLineItems, Integer, Hash)] Stripe::PaymentPagesCheckoutSessionListLineItems, response status code and response headers
    def get_checkout_sessions_session_line_items_with_http_info(
      *,
      session : String? = nil,
      ending_before : String? = nil,
      starting_after : String? = nil,
      limit : Int64? = nil,
      expand : Array(Array(String))? = nil
    ) : Tuple(Stripe::PaymentPagesCheckoutSessionListLineItems, Int32, Hash(String, Array(String) | String))
      request = build_api_request_for_get_checkout_sessions_session_line_items(session: session, ending_before: ending_before, starting_after: starting_after, limit: limit, expand: expand)

      body, status_code, headers = @api_client.execute_api_request(request)

      if debugging?
        Log.debug { "API called: CheckoutApi#get_checkout_sessions_session_line_items\nBody: #{body.inspect}\nStatus code: #{status_code}\nHeaders: #{headers}" }
      end

      Tuple.new(Stripe::PaymentPagesCheckoutSessionListLineItems.from_json(body), status_code, headers)
    end

    # &lt;p&gt;When retrieving a Checkout Session, there is an includable &lt;strong&gt;line_items&lt;/strong&gt; property containing the first handful of those items. There is also a URL where you can retrieve the full (paginated) list of line items.&lt;/p&gt;
    # @required @param session [String?]
    # @optional @param ending_before [String?] A cursor for use in pagination. `ending_before` is an object ID that defines your place in the list. For instance, if you make a list request and receive 100 objects, starting with `obj_bar`, your subsequent call can include `ending_before=obj_bar` in order to fetch the previous page of the list.
    # @optional @param starting_after [String?] A cursor for use in pagination. `starting_after` is an object ID that defines your place in the list. For instance, if you make a list request and receive 100 objects, ending with `obj_foo`, your subsequent call can include `starting_after=obj_foo` in order to fetch the next page of the list.
    # @optional @param limit [Int32?] A limit on the number of objects to be returned. Limit can range between 1 and 100, and the default is 10.
    # @optional @param expand [Array(Array(String))?] Specifies which fields in the response should be expanded.
    # @return nil
    def get_checkout_sessions_session_line_items(
      *,
      session : String? = nil,
      ending_before : String? = nil,
      starting_after : String? = nil,
      limit : Int64? = nil,
      expand : Array(Array(String))? = nil,
      &block : Crest::Response ->
    ) : Nil
      build_api_request_for_get_checkout_sessions_session_line_items(session: session, ending_before: ending_before, starting_after: starting_after, limit: limit, expand: expand).execute(&block)
    end

    GET_CHECKOUT_SESSIONS_SESSION_LINE_ITEMS_MAX_LENGTH_FOR_SESSION        = 5000
    GET_CHECKOUT_SESSIONS_SESSION_LINE_ITEMS_MAX_LENGTH_FOR_ENDING_BEFORE  = 5000
    GET_CHECKOUT_SESSIONS_SESSION_LINE_ITEMS_MAX_LENGTH_FOR_STARTING_AFTER = 5000

    # @return Crest::Request
    def build_api_request_for_get_checkout_sessions_session_line_items(
      *,
      session : String? = nil,
      ending_before : String? = nil,
      starting_after : String? = nil,
      limit : Int64? = nil,
      expand : Array(Array(String))? = nil
    ) : Crest::Request
      if debugging?
        Log.debug { "Calling API: CheckoutApi.get_checkout_sessions_session_line_items ..." }
      end

      if client_side_validation?
        raise ArgumentError.new("\"session\" is required and cannot be null") if session.nil?
        unless (_session = session).nil?
          OpenApi::PrimitiveValidator.validate_max_length("session", session.to_s.size, GET_CHECKOUT_SESSIONS_SESSION_LINE_ITEMS_MAX_LENGTH_FOR_SESSION)
        end
        unless (_ending_before = ending_before).nil?
          OpenApi::PrimitiveValidator.validate_max_length("ending_before", ending_before.to_s.size, GET_CHECKOUT_SESSIONS_SESSION_LINE_ITEMS_MAX_LENGTH_FOR_ENDING_BEFORE)
        end
        unless (_starting_after = starting_after).nil?
          OpenApi::PrimitiveValidator.validate_max_length("starting_after", starting_after.to_s.size, GET_CHECKOUT_SESSIONS_SESSION_LINE_ITEMS_MAX_LENGTH_FOR_STARTING_AFTER)
        end
      end

      # resource path
      local_var_path = "/v1/checkout/sessions/{session}/line_items".sub("{" + "session" + "}", URI.encode_path(session.to_s))

      # header parameters
      header_params : Hash(String, String) = Hash(String, String).new
      # HTTP header "Accept" (if needed)
      header_params["Accept"] = @api_client.select_header_accept(["application/json"])

      # cookie parameters
      cookie_params : Hash(String, String) = Hash(String, String).new

      # query parameters
      query_params : Hash(String, (String | Array(String) | JSON::Any)) = Hash(String, (String | Array(String) | JSON::Any)).new
      query_params["ending_before"] = ending_before.to_s if !ending_before.nil?
      query_params["starting_after"] = starting_after.to_s if !starting_after.nil?
      query_params["limit"] = limit.to_s if !limit.nil?
      query_params["expand"] = @api_client.build_collection_param(expand, "csv") if !expand.nil? && !expand.empty?

      # form parameters
      form_params : Array(Tuple(String, Crest::ParamsValue)) | Nil = nil

      # http body (model)
      post_body : IO | String | Nil = nil

      # auth_names
      auth_names = ["basicAuth", "bearerAuth"]

      @api_client.build_api_request(
        http_method: :"GET",
        path: local_var_path,
        operation: "CheckoutApi.get_checkout_sessions_session_line_items",
        post_body: post_body,
        auth_names: auth_names,
        header_params: header_params,
        cookie_params: cookie_params,
        query_params: query_params,
        form_params: form_params
      )
    end

    # <p>Creates a Session object.</p>
    # @optional @param after_expiration [Stripe::AfterExpirationParams?]
    # @optional @param allow_promotion_codes [Bool?] Enables user redeemable promotion codes.
    # @optional @param automatic_tax [Stripe::AutomaticTaxParams?]
    # @optional @param billing_address_collection [String?] Specify whether Checkout should collect the customer's billing address. Defaults to `auto`.
    # @optional @param cancel_url [String?] If set, Checkout displays a back button and customers will be directed to this URL if they decide to cancel payment and return to your website. This parameter is not allowed if ui_mode is `embedded`.
    # @optional @param client_reference_id [String?] A unique string to reference the Checkout Session. This can be a customer ID, a cart ID, or similar, and can be used to reconcile the session with your internal systems.
    # @optional @param consent_collection [Stripe::ConsentCollectionParams?]
    # @optional @param currency [String?] Three-letter [ISO currency code](https://www.iso.org/iso-4217-currency-codes.html), in lowercase. Must be a [supported currency](https://stripe.com/docs/currencies). Required in `setup` mode when `payment_method_types` is not set.
    # @optional @param custom_fields [Array(Stripe::CustomFieldParam)?] Collect additional information from your customer using custom fields. Up to 3 fields are supported.
    # @optional @param custom_text [Stripe::CustomTextParam?]
    # @optional @param customer [String?] ID of an existing Customer, if one exists. In `payment` mode, the customer’s most recently saved card payment method will be used to prefill the email, name, card details, and billing address on the Checkout page. In `subscription` mode, the customer’s [default payment method](https://stripe.com/docs/api/customers/update#update_customer-invoice_settings-default_payment_method) will be used if it’s a card, otherwise the most recently saved card will be used. A valid billing address, billing name and billing email are required on the payment method for Checkout to prefill the customer's card details.  If the Customer already has a valid [email](https://stripe.com/docs/api/customers/object#customer_object-email) set, the email will be prefilled and not editable in Checkout. If the Customer does not have a valid `email`, Checkout will set the email entered during the session on the Customer.  If blank for Checkout Sessions in `subscription` mode or with `customer_creation` set as `always` in `payment` mode, Checkout will create a new Customer object based on information provided during the payment flow.  You can set [`payment_intent_data.setup_future_usage`](https://stripe.com/docs/api/checkout/sessions/create#create_checkout_session-payment_intent_data-setup_future_usage) to have Checkout automatically attach the payment method to the Customer you pass in for future reuse.
    # @optional @param customer_creation [String?] Configure whether a Checkout Session creates a [Customer](https://stripe.com/docs/api/customers) during Session confirmation.  When a Customer is not created, you can still retrieve email, address, and other customer data entered in Checkout with [customer_details](https://stripe.com/docs/api/checkout/sessions/object#checkout_session_object-customer_details).  Sessions that don't create Customers instead are grouped by [guest customers](https://stripe.com/docs/payments/checkout/guest-customers) in the Dashboard. Promotion codes limited to first time customers will return invalid for these Sessions.  Can only be set in `payment` and `setup` mode.
    # @optional @param customer_email [String?] If provided, this value will be used when the Customer object is created. If not provided, customers will be asked to enter their email address. Use this parameter to prefill customer data if you already have an email on file. To access information about the customer once a session is complete, use the `customer` field.
    # @optional @param customer_update [Stripe::CustomerUpdateParams?]
    # @optional @param discounts [Array(Stripe::DiscountParams)?] The coupon or promotion code to apply to this Session. Currently, only up to one may be specified.
    # @optional @param expand [Array(String)?] Specifies which fields in the response should be expanded.
    # @optional @param expires_at [Int32?] The Epoch time in seconds at which the Checkout Session will expire. It can be anywhere from 30 minutes to 24 hours after Checkout Session creation. By default, this value is 24 hours from creation.
    # @optional @param invoice_creation [Stripe::InvoiceCreationParams?]
    # @optional @param line_items [Array(Stripe::LineItemParams)?] A list of items the customer is purchasing. Use this parameter to pass one-time or recurring [Prices](https://stripe.com/docs/api/prices).  For `payment` mode, there is a maximum of 100 line items, however it is recommended to consolidate line items if there are more than a few dozen.  For `subscription` mode, there is a maximum of 20 line items with recurring Prices and 20 line items with one-time Prices. Line items with one-time Prices will be on the initial invoice only.
    # @optional @param locale [String?] The IETF language tag of the locale Checkout is displayed in. If blank or `auto`, the browser's locale is used.
    # @optional @param metadata [Hash(String, String)?]
    # @optional @param mode [String?] The mode of the Checkout Session. Pass `subscription` if the Checkout Session includes at least one recurring item.
    # @optional @param payment_intent_data [Stripe::PaymentIntentDataParams?]
    # @optional @param payment_method_collection [String?] Specify whether Checkout should collect a payment method. When set to `if_required`, Checkout will not collect a payment method when the total due for the session is 0. This may occur if the Checkout Session includes a free trial or a discount.  Can only be set in `subscription` mode. Defaults to `always`.  If you'd like information on how to collect a payment method outside of Checkout, read the guide on configuring [subscriptions with a free trial](https://stripe.com/docs/payments/checkout/free-trials).
    # @optional @param payment_method_configuration [String?] The ID of the payment method configuration to use with this Checkout session.
    # @optional @param payment_method_data [Stripe::PaymentMethodDataParam?]
    # @optional @param payment_method_options [Stripe::PaymentMethodOptionsParam?]
    # @optional @param payment_method_types [Array(String)?] A list of the types of payment methods (e.g., `card`) this Checkout Session can accept.  You can omit this attribute to manage your payment methods from the [Stripe Dashboard](https://dashboard.stripe.com/settings/payment_methods). See [Dynamic Payment Methods](https://stripe.com/docs/payments/payment-methods/integration-options#using-dynamic-payment-methods) for more details.  Read more about the supported payment methods and their requirements in our [payment method details guide](/docs/payments/checkout/payment-methods).  If multiple payment methods are passed, Checkout will dynamically reorder them to prioritize the most relevant payment methods based on the customer's location and other characteristics.
    # @optional @param phone_number_collection [Stripe::PhoneNumberCollectionParams?]
    # @optional @param redirect_on_completion [String?] This parameter applies to `ui_mode: embedded`. Learn more about the [redirect behavior](https://stripe.com/docs/payments/checkout/custom-redirect-behavior) of embedded sessions. Defaults to `always`.
    # @optional @param return_url [String?] The URL to redirect your customer back to after they authenticate or cancel their payment on the payment method's app or site. This parameter is required if ui_mode is `embedded` and redirect-based payment methods are enabled on the session.
    # @optional @param saved_payment_method_options [Stripe::SavedPaymentMethodOptionsParam?]
    # @optional @param setup_intent_data [Stripe::SetupIntentDataParam?]
    # @optional @param shipping_address_collection [Stripe::ShippingAddressCollectionParams?]
    # @optional @param shipping_options [Array(Stripe::ShippingOptionParams)?] The shipping rate options to apply to this Session. Up to a maximum of 5.
    # @optional @param submit_type [String?] Describes the type of transaction being performed by Checkout in order to customize relevant text on the page, such as the submit button. `submit_type` can only be specified on Checkout Sessions in `payment` mode. If blank or `auto`, `pay` is used.
    # @optional @param subscription_data [Stripe::SubscriptionDataParams?]
    # @optional @param success_url [String?] The URL to which Stripe should send customers when payment or setup is complete. This parameter is not allowed if ui_mode is `embedded`. If you’d like to use information from the successful Checkout Session on your page, read the guide on [customizing your success page](https://stripe.com/docs/payments/checkout/custom-success-page).
    # @optional @param tax_id_collection [Stripe::TaxIdCollectionParams?]
    # @optional @param ui_mode [String?] The UI mode of the Session. Defaults to `hosted`.
    # @return [Stripe::CheckoutSession]
    def post_checkout_sessions(
      *,
      after_expiration : Stripe::AfterExpirationParams? = nil,
      allow_promotion_codes : Bool? = nil,
      automatic_tax : Stripe::AutomaticTaxParams? = nil,
      billing_address_collection : String? = nil,
      cancel_url : String? = nil,
      client_reference_id : String? = nil,
      consent_collection : Stripe::ConsentCollectionParams? = nil,
      currency : String? = nil,
      custom_fields : Array(Stripe::CustomFieldParam)? = nil,
      custom_text : Stripe::CustomTextParam? = nil,
      customer : String? = nil,
      customer_creation : String? = nil,
      customer_email : String? = nil,
      customer_update : Stripe::CustomerUpdateParams? = nil,
      discounts : Array(Stripe::DiscountParams)? = nil,
      expand : Array(String)? = nil,
      expires_at : Int64? = nil,
      invoice_creation : Stripe::InvoiceCreationParams? = nil,
      line_items : Array(Stripe::LineItemParams)? = nil,
      locale : String? = nil,
      metadata : Hash(String, String)? = nil,
      mode : String? = nil,
      payment_intent_data : Stripe::PaymentIntentDataParams? = nil,
      payment_method_collection : String? = nil,
      payment_method_configuration : String? = nil,
      payment_method_data : Stripe::PaymentMethodDataParam? = nil,
      payment_method_options : Stripe::PaymentMethodOptionsParam? = nil,
      payment_method_types : Array(String)? = nil,
      phone_number_collection : Stripe::PhoneNumberCollectionParams? = nil,
      redirect_on_completion : String? = nil,
      return_url : String? = nil,
      saved_payment_method_options : Stripe::SavedPaymentMethodOptionsParam? = nil,
      setup_intent_data : Stripe::SetupIntentDataParam? = nil,
      shipping_address_collection : Stripe::ShippingAddressCollectionParams? = nil,
      shipping_options : Array(Stripe::ShippingOptionParams)? = nil,
      submit_type : String? = nil,
      subscription_data : Stripe::SubscriptionDataParams? = nil,
      success_url : String? = nil,
      tax_id_collection : Stripe::TaxIdCollectionParams? = nil,
      ui_mode : String? = nil
    ) : Stripe::CheckoutSession
      data, _status_code, _headers = post_checkout_sessions_with_http_info(after_expiration: after_expiration, allow_promotion_codes: allow_promotion_codes, automatic_tax: automatic_tax, billing_address_collection: billing_address_collection, cancel_url: cancel_url, client_reference_id: client_reference_id, consent_collection: consent_collection, currency: currency, custom_fields: custom_fields, custom_text: custom_text, customer: customer, customer_creation: customer_creation, customer_email: customer_email, customer_update: customer_update, discounts: discounts, expand: expand, expires_at: expires_at, invoice_creation: invoice_creation, line_items: line_items, locale: locale, metadata: metadata, mode: mode, payment_intent_data: payment_intent_data, payment_method_collection: payment_method_collection, payment_method_configuration: payment_method_configuration, payment_method_data: payment_method_data, payment_method_options: payment_method_options, payment_method_types: payment_method_types, phone_number_collection: phone_number_collection, redirect_on_completion: redirect_on_completion, return_url: return_url, saved_payment_method_options: saved_payment_method_options, setup_intent_data: setup_intent_data, shipping_address_collection: shipping_address_collection, shipping_options: shipping_options, submit_type: submit_type, subscription_data: subscription_data, success_url: success_url, tax_id_collection: tax_id_collection, ui_mode: ui_mode)
      data
    end

    # &lt;p&gt;Creates a Session object.&lt;/p&gt;
    # @optional @param after_expiration [Stripe::AfterExpirationParams?]
    # @optional @param allow_promotion_codes [Bool?] Enables user redeemable promotion codes.
    # @optional @param automatic_tax [Stripe::AutomaticTaxParams?]
    # @optional @param billing_address_collection [String?] Specify whether Checkout should collect the customer's billing address. Defaults to `auto`.
    # @optional @param cancel_url [String?] If set, Checkout displays a back button and customers will be directed to this URL if they decide to cancel payment and return to your website. This parameter is not allowed if ui_mode is `embedded`.
    # @optional @param client_reference_id [String?] A unique string to reference the Checkout Session. This can be a customer ID, a cart ID, or similar, and can be used to reconcile the session with your internal systems.
    # @optional @param consent_collection [Stripe::ConsentCollectionParams?]
    # @optional @param currency [String?] Three-letter [ISO currency code](https://www.iso.org/iso-4217-currency-codes.html), in lowercase. Must be a [supported currency](https://stripe.com/docs/currencies). Required in `setup` mode when `payment_method_types` is not set.
    # @optional @param custom_fields [Array(Stripe::CustomFieldParam)?] Collect additional information from your customer using custom fields. Up to 3 fields are supported.
    # @optional @param custom_text [Stripe::CustomTextParam?]
    # @optional @param customer [String?] ID of an existing Customer, if one exists. In `payment` mode, the customer’s most recently saved card payment method will be used to prefill the email, name, card details, and billing address on the Checkout page. In `subscription` mode, the customer’s [default payment method](https://stripe.com/docs/api/customers/update#update_customer-invoice_settings-default_payment_method) will be used if it’s a card, otherwise the most recently saved card will be used. A valid billing address, billing name and billing email are required on the payment method for Checkout to prefill the customer's card details.  If the Customer already has a valid [email](https://stripe.com/docs/api/customers/object#customer_object-email) set, the email will be prefilled and not editable in Checkout. If the Customer does not have a valid `email`, Checkout will set the email entered during the session on the Customer.  If blank for Checkout Sessions in `subscription` mode or with `customer_creation` set as `always` in `payment` mode, Checkout will create a new Customer object based on information provided during the payment flow.  You can set [`payment_intent_data.setup_future_usage`](https://stripe.com/docs/api/checkout/sessions/create#create_checkout_session-payment_intent_data-setup_future_usage) to have Checkout automatically attach the payment method to the Customer you pass in for future reuse.
    # @optional @param customer_creation [String?] Configure whether a Checkout Session creates a [Customer](https://stripe.com/docs/api/customers) during Session confirmation.  When a Customer is not created, you can still retrieve email, address, and other customer data entered in Checkout with [customer_details](https://stripe.com/docs/api/checkout/sessions/object#checkout_session_object-customer_details).  Sessions that don't create Customers instead are grouped by [guest customers](https://stripe.com/docs/payments/checkout/guest-customers) in the Dashboard. Promotion codes limited to first time customers will return invalid for these Sessions.  Can only be set in `payment` and `setup` mode.
    # @optional @param customer_email [String?] If provided, this value will be used when the Customer object is created. If not provided, customers will be asked to enter their email address. Use this parameter to prefill customer data if you already have an email on file. To access information about the customer once a session is complete, use the `customer` field.
    # @optional @param customer_update [Stripe::CustomerUpdateParams?]
    # @optional @param discounts [Array(Stripe::DiscountParams)?] The coupon or promotion code to apply to this Session. Currently, only up to one may be specified.
    # @optional @param expand [Array(String)?] Specifies which fields in the response should be expanded.
    # @optional @param expires_at [Int32?] The Epoch time in seconds at which the Checkout Session will expire. It can be anywhere from 30 minutes to 24 hours after Checkout Session creation. By default, this value is 24 hours from creation.
    # @optional @param invoice_creation [Stripe::InvoiceCreationParams?]
    # @optional @param line_items [Array(Stripe::LineItemParams)?] A list of items the customer is purchasing. Use this parameter to pass one-time or recurring [Prices](https://stripe.com/docs/api/prices).  For `payment` mode, there is a maximum of 100 line items, however it is recommended to consolidate line items if there are more than a few dozen.  For `subscription` mode, there is a maximum of 20 line items with recurring Prices and 20 line items with one-time Prices. Line items with one-time Prices will be on the initial invoice only.
    # @optional @param locale [String?] The IETF language tag of the locale Checkout is displayed in. If blank or `auto`, the browser's locale is used.
    # @optional @param metadata [Hash(String, String)?]
    # @optional @param mode [String?] The mode of the Checkout Session. Pass `subscription` if the Checkout Session includes at least one recurring item.
    # @optional @param payment_intent_data [Stripe::PaymentIntentDataParams?]
    # @optional @param payment_method_collection [String?] Specify whether Checkout should collect a payment method. When set to `if_required`, Checkout will not collect a payment method when the total due for the session is 0. This may occur if the Checkout Session includes a free trial or a discount.  Can only be set in `subscription` mode. Defaults to `always`.  If you'd like information on how to collect a payment method outside of Checkout, read the guide on configuring [subscriptions with a free trial](https://stripe.com/docs/payments/checkout/free-trials).
    # @optional @param payment_method_configuration [String?] The ID of the payment method configuration to use with this Checkout session.
    # @optional @param payment_method_data [Stripe::PaymentMethodDataParam?]
    # @optional @param payment_method_options [Stripe::PaymentMethodOptionsParam?]
    # @optional @param payment_method_types [Array(String)?] A list of the types of payment methods (e.g., `card`) this Checkout Session can accept.  You can omit this attribute to manage your payment methods from the [Stripe Dashboard](https://dashboard.stripe.com/settings/payment_methods). See [Dynamic Payment Methods](https://stripe.com/docs/payments/payment-methods/integration-options#using-dynamic-payment-methods) for more details.  Read more about the supported payment methods and their requirements in our [payment method details guide](/docs/payments/checkout/payment-methods).  If multiple payment methods are passed, Checkout will dynamically reorder them to prioritize the most relevant payment methods based on the customer's location and other characteristics.
    # @optional @param phone_number_collection [Stripe::PhoneNumberCollectionParams?]
    # @optional @param redirect_on_completion [String?] This parameter applies to `ui_mode: embedded`. Learn more about the [redirect behavior](https://stripe.com/docs/payments/checkout/custom-redirect-behavior) of embedded sessions. Defaults to `always`.
    # @optional @param return_url [String?] The URL to redirect your customer back to after they authenticate or cancel their payment on the payment method's app or site. This parameter is required if ui_mode is `embedded` and redirect-based payment methods are enabled on the session.
    # @optional @param saved_payment_method_options [Stripe::SavedPaymentMethodOptionsParam?]
    # @optional @param setup_intent_data [Stripe::SetupIntentDataParam?]
    # @optional @param shipping_address_collection [Stripe::ShippingAddressCollectionParams?]
    # @optional @param shipping_options [Array(Stripe::ShippingOptionParams)?] The shipping rate options to apply to this Session. Up to a maximum of 5.
    # @optional @param submit_type [String?] Describes the type of transaction being performed by Checkout in order to customize relevant text on the page, such as the submit button. `submit_type` can only be specified on Checkout Sessions in `payment` mode. If blank or `auto`, `pay` is used.
    # @optional @param subscription_data [Stripe::SubscriptionDataParams?]
    # @optional @param success_url [String?] The URL to which Stripe should send customers when payment or setup is complete. This parameter is not allowed if ui_mode is `embedded`. If you’d like to use information from the successful Checkout Session on your page, read the guide on [customizing your success page](https://stripe.com/docs/payments/checkout/custom-success-page).
    # @optional @param tax_id_collection [Stripe::TaxIdCollectionParams?]
    # @optional @param ui_mode [String?] The UI mode of the Session. Defaults to `hosted`.
    # @return [Tuple(Stripe::CheckoutSession, Integer, Hash)] Stripe::CheckoutSession, response status code and response headers
    def post_checkout_sessions_with_http_info(
      *,
      after_expiration : Stripe::AfterExpirationParams? = nil,
      allow_promotion_codes : Bool? = nil,
      automatic_tax : Stripe::AutomaticTaxParams? = nil,
      billing_address_collection : String? = nil,
      cancel_url : String? = nil,
      client_reference_id : String? = nil,
      consent_collection : Stripe::ConsentCollectionParams? = nil,
      currency : String? = nil,
      custom_fields : Array(Stripe::CustomFieldParam)? = nil,
      custom_text : Stripe::CustomTextParam? = nil,
      customer : String? = nil,
      customer_creation : String? = nil,
      customer_email : String? = nil,
      customer_update : Stripe::CustomerUpdateParams? = nil,
      discounts : Array(Stripe::DiscountParams)? = nil,
      expand : Array(String)? = nil,
      expires_at : Int64? = nil,
      invoice_creation : Stripe::InvoiceCreationParams? = nil,
      line_items : Array(Stripe::LineItemParams)? = nil,
      locale : String? = nil,
      metadata : Hash(String, String)? = nil,
      mode : String? = nil,
      payment_intent_data : Stripe::PaymentIntentDataParams? = nil,
      payment_method_collection : String? = nil,
      payment_method_configuration : String? = nil,
      payment_method_data : Stripe::PaymentMethodDataParam? = nil,
      payment_method_options : Stripe::PaymentMethodOptionsParam? = nil,
      payment_method_types : Array(String)? = nil,
      phone_number_collection : Stripe::PhoneNumberCollectionParams? = nil,
      redirect_on_completion : String? = nil,
      return_url : String? = nil,
      saved_payment_method_options : Stripe::SavedPaymentMethodOptionsParam? = nil,
      setup_intent_data : Stripe::SetupIntentDataParam? = nil,
      shipping_address_collection : Stripe::ShippingAddressCollectionParams? = nil,
      shipping_options : Array(Stripe::ShippingOptionParams)? = nil,
      submit_type : String? = nil,
      subscription_data : Stripe::SubscriptionDataParams? = nil,
      success_url : String? = nil,
      tax_id_collection : Stripe::TaxIdCollectionParams? = nil,
      ui_mode : String? = nil
    ) : Tuple(Stripe::CheckoutSession, Int32, Hash(String, Array(String) | String))
      request = build_api_request_for_post_checkout_sessions(after_expiration: after_expiration, allow_promotion_codes: allow_promotion_codes, automatic_tax: automatic_tax, billing_address_collection: billing_address_collection, cancel_url: cancel_url, client_reference_id: client_reference_id, consent_collection: consent_collection, currency: currency, custom_fields: custom_fields, custom_text: custom_text, customer: customer, customer_creation: customer_creation, customer_email: customer_email, customer_update: customer_update, discounts: discounts, expand: expand, expires_at: expires_at, invoice_creation: invoice_creation, line_items: line_items, locale: locale, metadata: metadata, mode: mode, payment_intent_data: payment_intent_data, payment_method_collection: payment_method_collection, payment_method_configuration: payment_method_configuration, payment_method_data: payment_method_data, payment_method_options: payment_method_options, payment_method_types: payment_method_types, phone_number_collection: phone_number_collection, redirect_on_completion: redirect_on_completion, return_url: return_url, saved_payment_method_options: saved_payment_method_options, setup_intent_data: setup_intent_data, shipping_address_collection: shipping_address_collection, shipping_options: shipping_options, submit_type: submit_type, subscription_data: subscription_data, success_url: success_url, tax_id_collection: tax_id_collection, ui_mode: ui_mode)

      body, status_code, headers = @api_client.execute_api_request(request)

      if debugging?
        Log.debug { "API called: CheckoutApi#post_checkout_sessions\nBody: #{body.inspect}\nStatus code: #{status_code}\nHeaders: #{headers}" }
      end

      Tuple.new(Stripe::CheckoutSession.from_json(body), status_code, headers)
    end

    # &lt;p&gt;Creates a Session object.&lt;/p&gt;
    # @optional @param after_expiration [Stripe::AfterExpirationParams?]
    # @optional @param allow_promotion_codes [Bool?] Enables user redeemable promotion codes.
    # @optional @param automatic_tax [Stripe::AutomaticTaxParams?]
    # @optional @param billing_address_collection [String?] Specify whether Checkout should collect the customer's billing address. Defaults to `auto`.
    # @optional @param cancel_url [String?] If set, Checkout displays a back button and customers will be directed to this URL if they decide to cancel payment and return to your website. This parameter is not allowed if ui_mode is `embedded`.
    # @optional @param client_reference_id [String?] A unique string to reference the Checkout Session. This can be a customer ID, a cart ID, or similar, and can be used to reconcile the session with your internal systems.
    # @optional @param consent_collection [Stripe::ConsentCollectionParams?]
    # @optional @param currency [String?] Three-letter [ISO currency code](https://www.iso.org/iso-4217-currency-codes.html), in lowercase. Must be a [supported currency](https://stripe.com/docs/currencies). Required in `setup` mode when `payment_method_types` is not set.
    # @optional @param custom_fields [Array(Stripe::CustomFieldParam)?] Collect additional information from your customer using custom fields. Up to 3 fields are supported.
    # @optional @param custom_text [Stripe::CustomTextParam?]
    # @optional @param customer [String?] ID of an existing Customer, if one exists. In `payment` mode, the customer’s most recently saved card payment method will be used to prefill the email, name, card details, and billing address on the Checkout page. In `subscription` mode, the customer’s [default payment method](https://stripe.com/docs/api/customers/update#update_customer-invoice_settings-default_payment_method) will be used if it’s a card, otherwise the most recently saved card will be used. A valid billing address, billing name and billing email are required on the payment method for Checkout to prefill the customer's card details.  If the Customer already has a valid [email](https://stripe.com/docs/api/customers/object#customer_object-email) set, the email will be prefilled and not editable in Checkout. If the Customer does not have a valid `email`, Checkout will set the email entered during the session on the Customer.  If blank for Checkout Sessions in `subscription` mode or with `customer_creation` set as `always` in `payment` mode, Checkout will create a new Customer object based on information provided during the payment flow.  You can set [`payment_intent_data.setup_future_usage`](https://stripe.com/docs/api/checkout/sessions/create#create_checkout_session-payment_intent_data-setup_future_usage) to have Checkout automatically attach the payment method to the Customer you pass in for future reuse.
    # @optional @param customer_creation [String?] Configure whether a Checkout Session creates a [Customer](https://stripe.com/docs/api/customers) during Session confirmation.  When a Customer is not created, you can still retrieve email, address, and other customer data entered in Checkout with [customer_details](https://stripe.com/docs/api/checkout/sessions/object#checkout_session_object-customer_details).  Sessions that don't create Customers instead are grouped by [guest customers](https://stripe.com/docs/payments/checkout/guest-customers) in the Dashboard. Promotion codes limited to first time customers will return invalid for these Sessions.  Can only be set in `payment` and `setup` mode.
    # @optional @param customer_email [String?] If provided, this value will be used when the Customer object is created. If not provided, customers will be asked to enter their email address. Use this parameter to prefill customer data if you already have an email on file. To access information about the customer once a session is complete, use the `customer` field.
    # @optional @param customer_update [Stripe::CustomerUpdateParams?]
    # @optional @param discounts [Array(Stripe::DiscountParams)?] The coupon or promotion code to apply to this Session. Currently, only up to one may be specified.
    # @optional @param expand [Array(String)?] Specifies which fields in the response should be expanded.
    # @optional @param expires_at [Int32?] The Epoch time in seconds at which the Checkout Session will expire. It can be anywhere from 30 minutes to 24 hours after Checkout Session creation. By default, this value is 24 hours from creation.
    # @optional @param invoice_creation [Stripe::InvoiceCreationParams?]
    # @optional @param line_items [Array(Stripe::LineItemParams)?] A list of items the customer is purchasing. Use this parameter to pass one-time or recurring [Prices](https://stripe.com/docs/api/prices).  For `payment` mode, there is a maximum of 100 line items, however it is recommended to consolidate line items if there are more than a few dozen.  For `subscription` mode, there is a maximum of 20 line items with recurring Prices and 20 line items with one-time Prices. Line items with one-time Prices will be on the initial invoice only.
    # @optional @param locale [String?] The IETF language tag of the locale Checkout is displayed in. If blank or `auto`, the browser's locale is used.
    # @optional @param metadata [Hash(String, String)?]
    # @optional @param mode [String?] The mode of the Checkout Session. Pass `subscription` if the Checkout Session includes at least one recurring item.
    # @optional @param payment_intent_data [Stripe::PaymentIntentDataParams?]
    # @optional @param payment_method_collection [String?] Specify whether Checkout should collect a payment method. When set to `if_required`, Checkout will not collect a payment method when the total due for the session is 0. This may occur if the Checkout Session includes a free trial or a discount.  Can only be set in `subscription` mode. Defaults to `always`.  If you'd like information on how to collect a payment method outside of Checkout, read the guide on configuring [subscriptions with a free trial](https://stripe.com/docs/payments/checkout/free-trials).
    # @optional @param payment_method_configuration [String?] The ID of the payment method configuration to use with this Checkout session.
    # @optional @param payment_method_data [Stripe::PaymentMethodDataParam?]
    # @optional @param payment_method_options [Stripe::PaymentMethodOptionsParam?]
    # @optional @param payment_method_types [Array(String)?] A list of the types of payment methods (e.g., `card`) this Checkout Session can accept.  You can omit this attribute to manage your payment methods from the [Stripe Dashboard](https://dashboard.stripe.com/settings/payment_methods). See [Dynamic Payment Methods](https://stripe.com/docs/payments/payment-methods/integration-options#using-dynamic-payment-methods) for more details.  Read more about the supported payment methods and their requirements in our [payment method details guide](/docs/payments/checkout/payment-methods).  If multiple payment methods are passed, Checkout will dynamically reorder them to prioritize the most relevant payment methods based on the customer's location and other characteristics.
    # @optional @param phone_number_collection [Stripe::PhoneNumberCollectionParams?]
    # @optional @param redirect_on_completion [String?] This parameter applies to `ui_mode: embedded`. Learn more about the [redirect behavior](https://stripe.com/docs/payments/checkout/custom-redirect-behavior) of embedded sessions. Defaults to `always`.
    # @optional @param return_url [String?] The URL to redirect your customer back to after they authenticate or cancel their payment on the payment method's app or site. This parameter is required if ui_mode is `embedded` and redirect-based payment methods are enabled on the session.
    # @optional @param saved_payment_method_options [Stripe::SavedPaymentMethodOptionsParam?]
    # @optional @param setup_intent_data [Stripe::SetupIntentDataParam?]
    # @optional @param shipping_address_collection [Stripe::ShippingAddressCollectionParams?]
    # @optional @param shipping_options [Array(Stripe::ShippingOptionParams)?] The shipping rate options to apply to this Session. Up to a maximum of 5.
    # @optional @param submit_type [String?] Describes the type of transaction being performed by Checkout in order to customize relevant text on the page, such as the submit button. `submit_type` can only be specified on Checkout Sessions in `payment` mode. If blank or `auto`, `pay` is used.
    # @optional @param subscription_data [Stripe::SubscriptionDataParams?]
    # @optional @param success_url [String?] The URL to which Stripe should send customers when payment or setup is complete. This parameter is not allowed if ui_mode is `embedded`. If you’d like to use information from the successful Checkout Session on your page, read the guide on [customizing your success page](https://stripe.com/docs/payments/checkout/custom-success-page).
    # @optional @param tax_id_collection [Stripe::TaxIdCollectionParams?]
    # @optional @param ui_mode [String?] The UI mode of the Session. Defaults to `hosted`.
    # @return nil
    def post_checkout_sessions(
      *,
      after_expiration : Stripe::AfterExpirationParams? = nil,
      allow_promotion_codes : Bool? = nil,
      automatic_tax : Stripe::AutomaticTaxParams? = nil,
      billing_address_collection : String? = nil,
      cancel_url : String? = nil,
      client_reference_id : String? = nil,
      consent_collection : Stripe::ConsentCollectionParams? = nil,
      currency : String? = nil,
      custom_fields : Array(Stripe::CustomFieldParam)? = nil,
      custom_text : Stripe::CustomTextParam? = nil,
      customer : String? = nil,
      customer_creation : String? = nil,
      customer_email : String? = nil,
      customer_update : Stripe::CustomerUpdateParams? = nil,
      discounts : Array(Stripe::DiscountParams)? = nil,
      expand : Array(String)? = nil,
      expires_at : Int64? = nil,
      invoice_creation : Stripe::InvoiceCreationParams? = nil,
      line_items : Array(Stripe::LineItemParams)? = nil,
      locale : String? = nil,
      metadata : Hash(String, String)? = nil,
      mode : String? = nil,
      payment_intent_data : Stripe::PaymentIntentDataParams? = nil,
      payment_method_collection : String? = nil,
      payment_method_configuration : String? = nil,
      payment_method_data : Stripe::PaymentMethodDataParam? = nil,
      payment_method_options : Stripe::PaymentMethodOptionsParam? = nil,
      payment_method_types : Array(String)? = nil,
      phone_number_collection : Stripe::PhoneNumberCollectionParams? = nil,
      redirect_on_completion : String? = nil,
      return_url : String? = nil,
      saved_payment_method_options : Stripe::SavedPaymentMethodOptionsParam? = nil,
      setup_intent_data : Stripe::SetupIntentDataParam? = nil,
      shipping_address_collection : Stripe::ShippingAddressCollectionParams? = nil,
      shipping_options : Array(Stripe::ShippingOptionParams)? = nil,
      submit_type : String? = nil,
      subscription_data : Stripe::SubscriptionDataParams? = nil,
      success_url : String? = nil,
      tax_id_collection : Stripe::TaxIdCollectionParams? = nil,
      ui_mode : String? = nil,
      &block : Crest::Response ->
    ) : Nil
      build_api_request_for_post_checkout_sessions(after_expiration: after_expiration, allow_promotion_codes: allow_promotion_codes, automatic_tax: automatic_tax, billing_address_collection: billing_address_collection, cancel_url: cancel_url, client_reference_id: client_reference_id, consent_collection: consent_collection, currency: currency, custom_fields: custom_fields, custom_text: custom_text, customer: customer, customer_creation: customer_creation, customer_email: customer_email, customer_update: customer_update, discounts: discounts, expand: expand, expires_at: expires_at, invoice_creation: invoice_creation, line_items: line_items, locale: locale, metadata: metadata, mode: mode, payment_intent_data: payment_intent_data, payment_method_collection: payment_method_collection, payment_method_configuration: payment_method_configuration, payment_method_data: payment_method_data, payment_method_options: payment_method_options, payment_method_types: payment_method_types, phone_number_collection: phone_number_collection, redirect_on_completion: redirect_on_completion, return_url: return_url, saved_payment_method_options: saved_payment_method_options, setup_intent_data: setup_intent_data, shipping_address_collection: shipping_address_collection, shipping_options: shipping_options, submit_type: submit_type, subscription_data: subscription_data, success_url: success_url, tax_id_collection: tax_id_collection, ui_mode: ui_mode).execute(&block)
    end

    POST_CHECKOUT_SESSIONS_VALID_VALUES_FOR_BILLING_ADDRESS_COLLECTION = String.static_array("auto", "required")
    POST_CHECKOUT_SESSIONS_MAX_LENGTH_FOR_CANCEL_URL                   = 5000
    POST_CHECKOUT_SESSIONS_MAX_LENGTH_FOR_CLIENT_REFERENCE_ID          =  200
    POST_CHECKOUT_SESSIONS_MAX_LENGTH_FOR_CUSTOMER                     = 5000
    POST_CHECKOUT_SESSIONS_VALID_VALUES_FOR_CUSTOMER_CREATION          = String.static_array("always", "if_required")
    POST_CHECKOUT_SESSIONS_VALID_VALUES_FOR_LOCALE                     = String.static_array("auto", "bg", "cs", "da", "de", "el", "en", "en-GB", "es", "es-419", "et", "fi", "fil", "fr", "fr-CA", "hr", "hu", "id", "it", "ja", "ko", "lt", "lv", "ms", "mt", "nb", "nl", "pl", "pt", "pt-BR", "ro", "ru", "sk", "sl", "sv", "th", "tr", "vi", "zh", "zh-HK", "zh-TW")
    POST_CHECKOUT_SESSIONS_VALID_VALUES_FOR_MODE                       = String.static_array("payment", "setup", "subscription")
    POST_CHECKOUT_SESSIONS_VALID_VALUES_FOR_PAYMENT_METHOD_COLLECTION  = String.static_array("always", "if_required")
    POST_CHECKOUT_SESSIONS_MAX_LENGTH_FOR_PAYMENT_METHOD_CONFIGURATION = 100
    POST_CHECKOUT_SESSIONS_VALID_VALUES_FOR_PAYMENT_METHOD_TYPES       = String.static_array("acss_debit", "affirm", "afterpay_clearpay", "alipay", "amazon_pay", "au_becs_debit", "bacs_debit", "bancontact", "blik", "boleto", "card", "cashapp", "customer_balance", "eps", "fpx", "giropay", "grabpay", "ideal", "klarna", "konbini", "link", "mobilepay", "multibanco", "oxxo", "p24", "paynow", "paypal", "pix", "promptpay", "revolut_pay", "sepa_debit", "sofort", "swish", "twint", "us_bank_account", "wechat_pay", "zip")
    POST_CHECKOUT_SESSIONS_VALID_VALUES_FOR_REDIRECT_ON_COMPLETION     = String.static_array("always", "if_required", "never")
    POST_CHECKOUT_SESSIONS_MAX_LENGTH_FOR_RETURN_URL                   = 5000
    POST_CHECKOUT_SESSIONS_VALID_VALUES_FOR_SUBMIT_TYPE                = String.static_array("auto", "book", "donate", "pay")
    POST_CHECKOUT_SESSIONS_MAX_LENGTH_FOR_SUCCESS_URL                  = 5000
    POST_CHECKOUT_SESSIONS_VALID_VALUES_FOR_UI_MODE                    = String.static_array("embedded", "hosted")

    # @return Crest::Request
    def build_api_request_for_post_checkout_sessions(
      *,
      after_expiration : Stripe::AfterExpirationParams? = nil,
      allow_promotion_codes : Bool? = nil,
      automatic_tax : Stripe::AutomaticTaxParams? = nil,
      billing_address_collection : String? = nil,
      cancel_url : String? = nil,
      client_reference_id : String? = nil,
      consent_collection : Stripe::ConsentCollectionParams? = nil,
      currency : String? = nil,
      custom_fields : Array(Stripe::CustomFieldParam)? = nil,
      custom_text : Stripe::CustomTextParam? = nil,
      customer : String? = nil,
      customer_creation : String? = nil,
      customer_email : String? = nil,
      customer_update : Stripe::CustomerUpdateParams? = nil,
      discounts : Array(Stripe::DiscountParams)? = nil,
      expand : Array(String)? = nil,
      expires_at : Int64? = nil,
      invoice_creation : Stripe::InvoiceCreationParams? = nil,
      line_items : Array(Stripe::LineItemParams)? = nil,
      locale : String? = nil,
      metadata : Hash(String, String)? = nil,
      mode : String? = nil,
      payment_intent_data : Stripe::PaymentIntentDataParams? = nil,
      payment_method_collection : String? = nil,
      payment_method_configuration : String? = nil,
      payment_method_data : Stripe::PaymentMethodDataParam? = nil,
      payment_method_options : Stripe::PaymentMethodOptionsParam? = nil,
      payment_method_types : Array(String)? = nil,
      phone_number_collection : Stripe::PhoneNumberCollectionParams? = nil,
      redirect_on_completion : String? = nil,
      return_url : String? = nil,
      saved_payment_method_options : Stripe::SavedPaymentMethodOptionsParam? = nil,
      setup_intent_data : Stripe::SetupIntentDataParam? = nil,
      shipping_address_collection : Stripe::ShippingAddressCollectionParams? = nil,
      shipping_options : Array(Stripe::ShippingOptionParams)? = nil,
      submit_type : String? = nil,
      subscription_data : Stripe::SubscriptionDataParams? = nil,
      success_url : String? = nil,
      tax_id_collection : Stripe::TaxIdCollectionParams? = nil,
      ui_mode : String? = nil
    ) : Crest::Request
      if debugging?
        Log.debug { "Calling API: CheckoutApi.post_checkout_sessions ..." }
      end

      if client_side_validation?
        unless (_after_expiration = after_expiration).nil?
          _after_expiration.validate if _after_expiration.is_a?(OpenApi::Validatable)
        end

        unless (_automatic_tax = automatic_tax).nil?
          _automatic_tax.validate if _automatic_tax.is_a?(OpenApi::Validatable)
        end
        unless (_billing_address_collection = billing_address_collection).nil?
          OpenApi::EnumValidator.validate("billing_address_collection", _billing_address_collection, POST_CHECKOUT_SESSIONS_VALID_VALUES_FOR_BILLING_ADDRESS_COLLECTION)
        end
        unless (_cancel_url = cancel_url).nil?
          OpenApi::PrimitiveValidator.validate_max_length("cancel_url", cancel_url.to_s.size, POST_CHECKOUT_SESSIONS_MAX_LENGTH_FOR_CANCEL_URL)
        end
        unless (_client_reference_id = client_reference_id).nil?
          OpenApi::PrimitiveValidator.validate_max_length("client_reference_id", client_reference_id.to_s.size, POST_CHECKOUT_SESSIONS_MAX_LENGTH_FOR_CLIENT_REFERENCE_ID)
        end
        unless (_consent_collection = consent_collection).nil?
          _consent_collection.validate if _consent_collection.is_a?(OpenApi::Validatable)
        end

        unless (_custom_fields = custom_fields).nil?
          OpenApi::ContainerValidator.validate(container: _custom_fields) if _custom_fields.is_a?(Array)
        end
        unless (_custom_text = custom_text).nil?
          _custom_text.validate if _custom_text.is_a?(OpenApi::Validatable)
        end
        unless (_customer = customer).nil?
          OpenApi::PrimitiveValidator.validate_max_length("customer", customer.to_s.size, POST_CHECKOUT_SESSIONS_MAX_LENGTH_FOR_CUSTOMER)
        end
        unless (_customer_creation = customer_creation).nil?
          OpenApi::EnumValidator.validate("customer_creation", _customer_creation, POST_CHECKOUT_SESSIONS_VALID_VALUES_FOR_CUSTOMER_CREATION)
        end

        unless (_customer_update = customer_update).nil?
          _customer_update.validate if _customer_update.is_a?(OpenApi::Validatable)
        end
        unless (_discounts = discounts).nil?
          OpenApi::ContainerValidator.validate(container: _discounts) if _discounts.is_a?(Array)
        end

        unless (_invoice_creation = invoice_creation).nil?
          _invoice_creation.validate if _invoice_creation.is_a?(OpenApi::Validatable)
        end
        unless (_line_items = line_items).nil?
          OpenApi::ContainerValidator.validate(container: _line_items) if _line_items.is_a?(Array)
        end
        unless (_locale = locale).nil?
          OpenApi::EnumValidator.validate("locale", _locale, POST_CHECKOUT_SESSIONS_VALID_VALUES_FOR_LOCALE)
        end

        unless (_mode = mode).nil?
          OpenApi::EnumValidator.validate("mode", _mode, POST_CHECKOUT_SESSIONS_VALID_VALUES_FOR_MODE)
        end
        unless (_payment_intent_data = payment_intent_data).nil?
          _payment_intent_data.validate if _payment_intent_data.is_a?(OpenApi::Validatable)
        end
        unless (_payment_method_collection = payment_method_collection).nil?
          OpenApi::EnumValidator.validate("payment_method_collection", _payment_method_collection, POST_CHECKOUT_SESSIONS_VALID_VALUES_FOR_PAYMENT_METHOD_COLLECTION)
        end
        unless (_payment_method_configuration = payment_method_configuration).nil?
          OpenApi::PrimitiveValidator.validate_max_length("payment_method_configuration", payment_method_configuration.to_s.size, POST_CHECKOUT_SESSIONS_MAX_LENGTH_FOR_PAYMENT_METHOD_CONFIGURATION)
        end
        unless (_payment_method_data = payment_method_data).nil?
          _payment_method_data.validate if _payment_method_data.is_a?(OpenApi::Validatable)
        end
        unless (_payment_method_options = payment_method_options).nil?
          _payment_method_options.validate if _payment_method_options.is_a?(OpenApi::Validatable)
        end
        unless (_payment_method_types = payment_method_types).nil?
          OpenApi::EnumValidator.validate("payment_method_types", _payment_method_types, POST_CHECKOUT_SESSIONS_VALID_VALUES_FOR_PAYMENT_METHOD_TYPES)
        end
        unless (_phone_number_collection = phone_number_collection).nil?
          _phone_number_collection.validate if _phone_number_collection.is_a?(OpenApi::Validatable)
        end
        unless (_redirect_on_completion = redirect_on_completion).nil?
          OpenApi::EnumValidator.validate("redirect_on_completion", _redirect_on_completion, POST_CHECKOUT_SESSIONS_VALID_VALUES_FOR_REDIRECT_ON_COMPLETION)
        end
        unless (_return_url = return_url).nil?
          OpenApi::PrimitiveValidator.validate_max_length("return_url", return_url.to_s.size, POST_CHECKOUT_SESSIONS_MAX_LENGTH_FOR_RETURN_URL)
        end
        unless (_saved_payment_method_options = saved_payment_method_options).nil?
          _saved_payment_method_options.validate if _saved_payment_method_options.is_a?(OpenApi::Validatable)
        end
        unless (_setup_intent_data = setup_intent_data).nil?
          _setup_intent_data.validate if _setup_intent_data.is_a?(OpenApi::Validatable)
        end
        unless (_shipping_address_collection = shipping_address_collection).nil?
          _shipping_address_collection.validate if _shipping_address_collection.is_a?(OpenApi::Validatable)
        end
        unless (_shipping_options = shipping_options).nil?
          OpenApi::ContainerValidator.validate(container: _shipping_options) if _shipping_options.is_a?(Array)
        end
        unless (_submit_type = submit_type).nil?
          OpenApi::EnumValidator.validate("submit_type", _submit_type, POST_CHECKOUT_SESSIONS_VALID_VALUES_FOR_SUBMIT_TYPE)
        end
        unless (_subscription_data = subscription_data).nil?
          _subscription_data.validate if _subscription_data.is_a?(OpenApi::Validatable)
        end
        unless (_success_url = success_url).nil?
          OpenApi::PrimitiveValidator.validate_max_length("success_url", success_url.to_s.size, POST_CHECKOUT_SESSIONS_MAX_LENGTH_FOR_SUCCESS_URL)
        end
        unless (_tax_id_collection = tax_id_collection).nil?
          _tax_id_collection.validate if _tax_id_collection.is_a?(OpenApi::Validatable)
        end
        unless (_ui_mode = ui_mode).nil?
          OpenApi::EnumValidator.validate("ui_mode", _ui_mode, POST_CHECKOUT_SESSIONS_VALID_VALUES_FOR_UI_MODE)
        end
      end

      # resource path
      local_var_path = "/v1/checkout/sessions"

      # header parameters
      header_params : Hash(String, String) = Hash(String, String).new
      # HTTP header "Accept" (if needed)
      header_params["Accept"] = @api_client.select_header_accept(["application/json"])
      # HTTP header "Content-Type"
      header_params["Content-Type"] = @api_client.select_header_content_type(["application/x-www-form-urlencoded"])

      # cookie parameters
      cookie_params : Hash(String, String) = Hash(String, String).new

      # query parameters
      query_params : Hash(String, (String | Array(String) | JSON::Any)) = Hash(String, (String | Array(String) | JSON::Any)).new

      # form parameters
      form_params : Array(Tuple(String, Crest::ParamsValue)) | Nil = Array(Tuple(String, Crest::ParamsValue)).new
      form_params.concat(Crest::ZeroEnumeratedFlatParamsEncoder.flatten_params(JSON.parse(after_expiration.to_json), "after_expiration")) if !after_expiration.nil?
      form_params << Tuple(String, Crest::ParamsValue).new("allow_promotion_codes", allow_promotion_codes.to_s) if !allow_promotion_codes.nil?
      form_params.concat(Crest::ZeroEnumeratedFlatParamsEncoder.flatten_params(JSON.parse(automatic_tax.to_json), "automatic_tax")) if !automatic_tax.nil?
      form_params << Tuple(String, Crest::ParamsValue).new("billing_address_collection", billing_address_collection.to_s) if !billing_address_collection.nil?
      form_params << Tuple(String, Crest::ParamsValue).new("cancel_url", cancel_url.to_s) if !cancel_url.nil?
      form_params << Tuple(String, Crest::ParamsValue).new("client_reference_id", client_reference_id.to_s) if !client_reference_id.nil?
      form_params.concat(Crest::ZeroEnumeratedFlatParamsEncoder.flatten_params(JSON.parse(consent_collection.to_json), "consent_collection")) if !consent_collection.nil?
      form_params << Tuple(String, Crest::ParamsValue).new("currency", currency.to_s) if !currency.nil?
      form_params.concat(Crest::ZeroEnumeratedFlatParamsEncoder.flatten_params(JSON.parse(custom_fields.to_json), "custom_fields")) if !custom_fields.nil?
      form_params.concat(Crest::ZeroEnumeratedFlatParamsEncoder.flatten_params(JSON.parse(custom_text.to_json), "custom_text")) if !custom_text.nil?
      form_params << Tuple(String, Crest::ParamsValue).new("customer", customer.to_s) if !customer.nil?
      form_params << Tuple(String, Crest::ParamsValue).new("customer_creation", customer_creation.to_s) if !customer_creation.nil?
      form_params << Tuple(String, Crest::ParamsValue).new("customer_email", customer_email.to_s) if !customer_email.nil?
      form_params.concat(Crest::ZeroEnumeratedFlatParamsEncoder.flatten_params(JSON.parse(customer_update.to_json), "customer_update")) if !customer_update.nil?
      form_params.concat(Crest::ZeroEnumeratedFlatParamsEncoder.flatten_params(JSON.parse(discounts.to_json), "discounts")) if !discounts.nil?
      form_params.concat(Crest::ZeroEnumeratedFlatParamsEncoder.flatten_params(JSON.parse(expand.to_json), "expand")) if !expand.nil?
      form_params << Tuple(String, Crest::ParamsValue).new("expires_at", expires_at.to_s) if !expires_at.nil?
      form_params.concat(Crest::ZeroEnumeratedFlatParamsEncoder.flatten_params(JSON.parse(invoice_creation.to_json), "invoice_creation")) if !invoice_creation.nil?
      form_params.concat(Crest::ZeroEnumeratedFlatParamsEncoder.flatten_params(JSON.parse(line_items.to_json), "line_items")) if !line_items.nil?
      form_params << Tuple(String, Crest::ParamsValue).new("locale", locale.to_s) if !locale.nil?
      form_params.concat(Crest::ZeroEnumeratedFlatParamsEncoder.flatten_params(JSON.parse(metadata.to_json), "metadata")) if !metadata.nil?
      form_params << Tuple(String, Crest::ParamsValue).new("mode", mode.to_s) if !mode.nil?
      form_params.concat(Crest::ZeroEnumeratedFlatParamsEncoder.flatten_params(JSON.parse(payment_intent_data.to_json), "payment_intent_data")) if !payment_intent_data.nil?
      form_params << Tuple(String, Crest::ParamsValue).new("payment_method_collection", payment_method_collection.to_s) if !payment_method_collection.nil?
      form_params << Tuple(String, Crest::ParamsValue).new("payment_method_configuration", payment_method_configuration.to_s) if !payment_method_configuration.nil?
      form_params.concat(Crest::ZeroEnumeratedFlatParamsEncoder.flatten_params(JSON.parse(payment_method_data.to_json), "payment_method_data")) if !payment_method_data.nil?
      form_params.concat(Crest::ZeroEnumeratedFlatParamsEncoder.flatten_params(JSON.parse(payment_method_options.to_json), "payment_method_options")) if !payment_method_options.nil?
      form_params.concat(Crest::ZeroEnumeratedFlatParamsEncoder.flatten_params(JSON.parse(payment_method_types.to_json), "payment_method_types")) if !payment_method_types.nil?
      form_params.concat(Crest::ZeroEnumeratedFlatParamsEncoder.flatten_params(JSON.parse(phone_number_collection.to_json), "phone_number_collection")) if !phone_number_collection.nil?
      form_params << Tuple(String, Crest::ParamsValue).new("redirect_on_completion", redirect_on_completion.to_s) if !redirect_on_completion.nil?
      form_params << Tuple(String, Crest::ParamsValue).new("return_url", return_url.to_s) if !return_url.nil?
      form_params.concat(Crest::ZeroEnumeratedFlatParamsEncoder.flatten_params(JSON.parse(saved_payment_method_options.to_json), "saved_payment_method_options")) if !saved_payment_method_options.nil?
      form_params.concat(Crest::ZeroEnumeratedFlatParamsEncoder.flatten_params(JSON.parse(setup_intent_data.to_json), "setup_intent_data")) if !setup_intent_data.nil?
      form_params.concat(Crest::ZeroEnumeratedFlatParamsEncoder.flatten_params(JSON.parse(shipping_address_collection.to_json), "shipping_address_collection")) if !shipping_address_collection.nil?
      form_params.concat(Crest::ZeroEnumeratedFlatParamsEncoder.flatten_params(JSON.parse(shipping_options.to_json), "shipping_options")) if !shipping_options.nil?
      form_params << Tuple(String, Crest::ParamsValue).new("submit_type", submit_type.to_s) if !submit_type.nil?
      form_params.concat(Crest::ZeroEnumeratedFlatParamsEncoder.flatten_params(JSON.parse(subscription_data.to_json), "subscription_data")) if !subscription_data.nil?
      form_params << Tuple(String, Crest::ParamsValue).new("success_url", success_url.to_s) if !success_url.nil?
      form_params.concat(Crest::ZeroEnumeratedFlatParamsEncoder.flatten_params(JSON.parse(tax_id_collection.to_json), "tax_id_collection")) if !tax_id_collection.nil?
      form_params << Tuple(String, Crest::ParamsValue).new("ui_mode", ui_mode.to_s) if !ui_mode.nil?

      # http body (model)
      post_body : IO | String | Nil = nil

      # auth_names
      auth_names = ["basicAuth", "bearerAuth"]

      @api_client.build_api_request(
        http_method: :"POST",
        path: local_var_path,
        operation: "CheckoutApi.post_checkout_sessions",
        post_body: post_body,
        auth_names: auth_names,
        header_params: header_params,
        cookie_params: cookie_params,
        query_params: query_params,
        form_params: form_params
      )
    end

    # <p>Updates a Session object.</p>
    # @required @param session [String?]
    # @optional @param expand [Array(String)?] Specifies which fields in the response should be expanded.
    # @optional @param metadata [Stripe::PostAccountsRequestMetadata?]
    # @return [Stripe::CheckoutSession]
    def post_checkout_sessions_session(
      *,
      session : String? = nil,
      expand : Array(String)? = nil,
      metadata : Stripe::PostAccountsRequestMetadata? = nil
    ) : Stripe::CheckoutSession
      data, _status_code, _headers = post_checkout_sessions_session_with_http_info(session: session, expand: expand, metadata: metadata)
      data
    end

    # &lt;p&gt;Updates a Session object.&lt;/p&gt;
    # @required @param session [String?]
    # @optional @param expand [Array(String)?] Specifies which fields in the response should be expanded.
    # @optional @param metadata [Stripe::PostAccountsRequestMetadata?]
    # @return [Tuple(Stripe::CheckoutSession, Integer, Hash)] Stripe::CheckoutSession, response status code and response headers
    def post_checkout_sessions_session_with_http_info(
      *,
      session : String? = nil,
      expand : Array(String)? = nil,
      metadata : Stripe::PostAccountsRequestMetadata? = nil
    ) : Tuple(Stripe::CheckoutSession, Int32, Hash(String, Array(String) | String))
      request = build_api_request_for_post_checkout_sessions_session(session: session, expand: expand, metadata: metadata)

      body, status_code, headers = @api_client.execute_api_request(request)

      if debugging?
        Log.debug { "API called: CheckoutApi#post_checkout_sessions_session\nBody: #{body.inspect}\nStatus code: #{status_code}\nHeaders: #{headers}" }
      end

      Tuple.new(Stripe::CheckoutSession.from_json(body), status_code, headers)
    end

    # &lt;p&gt;Updates a Session object.&lt;/p&gt;
    # @required @param session [String?]
    # @optional @param expand [Array(String)?] Specifies which fields in the response should be expanded.
    # @optional @param metadata [Stripe::PostAccountsRequestMetadata?]
    # @return nil
    def post_checkout_sessions_session(
      *,
      session : String? = nil,
      expand : Array(String)? = nil,
      metadata : Stripe::PostAccountsRequestMetadata? = nil,
      &block : Crest::Response ->
    ) : Nil
      build_api_request_for_post_checkout_sessions_session(session: session, expand: expand, metadata: metadata).execute(&block)
    end

    POST_CHECKOUT_SESSIONS_SESSION_MAX_LENGTH_FOR_SESSION = 5000

    # @return Crest::Request
    def build_api_request_for_post_checkout_sessions_session(
      *,
      session : String? = nil,
      expand : Array(String)? = nil,
      metadata : Stripe::PostAccountsRequestMetadata? = nil
    ) : Crest::Request
      if debugging?
        Log.debug { "Calling API: CheckoutApi.post_checkout_sessions_session ..." }
      end

      if client_side_validation?
        raise ArgumentError.new("\"session\" is required and cannot be null") if session.nil?
        unless (_session = session).nil?
          OpenApi::PrimitiveValidator.validate_max_length("session", session.to_s.size, POST_CHECKOUT_SESSIONS_SESSION_MAX_LENGTH_FOR_SESSION)
        end

        unless (_metadata = metadata).nil?
          _metadata.validate if _metadata.is_a?(OpenApi::Validatable)
        end
      end

      # resource path
      local_var_path = "/v1/checkout/sessions/{session}".sub("{" + "session" + "}", URI.encode_path(session.to_s))

      # header parameters
      header_params : Hash(String, String) = Hash(String, String).new
      # HTTP header "Accept" (if needed)
      header_params["Accept"] = @api_client.select_header_accept(["application/json"])
      # HTTP header "Content-Type"
      header_params["Content-Type"] = @api_client.select_header_content_type(["application/x-www-form-urlencoded"])

      # cookie parameters
      cookie_params : Hash(String, String) = Hash(String, String).new

      # query parameters
      query_params : Hash(String, (String | Array(String) | JSON::Any)) = Hash(String, (String | Array(String) | JSON::Any)).new

      # form parameters
      form_params : Array(Tuple(String, Crest::ParamsValue)) | Nil = Array(Tuple(String, Crest::ParamsValue)).new
      form_params.concat(Crest::ZeroEnumeratedFlatParamsEncoder.flatten_params(JSON.parse(expand.to_json), "expand")) if !expand.nil?
      form_params.concat(Crest::ZeroEnumeratedFlatParamsEncoder.flatten_params(JSON.parse(metadata.to_json), "metadata")) if !metadata.nil?

      # http body (model)
      post_body : IO | String | Nil = nil

      # auth_names
      auth_names = ["basicAuth", "bearerAuth"]

      @api_client.build_api_request(
        http_method: :"POST",
        path: local_var_path,
        operation: "CheckoutApi.post_checkout_sessions_session",
        post_body: post_body,
        auth_names: auth_names,
        header_params: header_params,
        cookie_params: cookie_params,
        query_params: query_params,
        form_params: form_params
      )
    end

    # <p>A Session can be expired when it is in one of these statuses: <code>open</code> </p>  <p>After it expires, a customer can’t complete a Session and customers loading the Session see a message saying the Session is expired.</p>
    # @required @param session [String?]
    # @optional @param expand [Array(String)?] Specifies which fields in the response should be expanded.
    # @return [Stripe::CheckoutSession]
    def post_checkout_sessions_session_expire(
      *,
      session : String? = nil,
      expand : Array(String)? = nil
    ) : Stripe::CheckoutSession
      data, _status_code, _headers = post_checkout_sessions_session_expire_with_http_info(session: session, expand: expand)
      data
    end

    # &lt;p&gt;A Session can be expired when it is in one of these statuses: &lt;code&gt;open&lt;/code&gt; &lt;/p&gt;  &lt;p&gt;After it expires, a customer can’t complete a Session and customers loading the Session see a message saying the Session is expired.&lt;/p&gt;
    # @required @param session [String?]
    # @optional @param expand [Array(String)?] Specifies which fields in the response should be expanded.
    # @return [Tuple(Stripe::CheckoutSession, Integer, Hash)] Stripe::CheckoutSession, response status code and response headers
    def post_checkout_sessions_session_expire_with_http_info(
      *,
      session : String? = nil,
      expand : Array(String)? = nil
    ) : Tuple(Stripe::CheckoutSession, Int32, Hash(String, Array(String) | String))
      request = build_api_request_for_post_checkout_sessions_session_expire(session: session, expand: expand)

      body, status_code, headers = @api_client.execute_api_request(request)

      if debugging?
        Log.debug { "API called: CheckoutApi#post_checkout_sessions_session_expire\nBody: #{body.inspect}\nStatus code: #{status_code}\nHeaders: #{headers}" }
      end

      Tuple.new(Stripe::CheckoutSession.from_json(body), status_code, headers)
    end

    # &lt;p&gt;A Session can be expired when it is in one of these statuses: &lt;code&gt;open&lt;/code&gt; &lt;/p&gt;  &lt;p&gt;After it expires, a customer can’t complete a Session and customers loading the Session see a message saying the Session is expired.&lt;/p&gt;
    # @required @param session [String?]
    # @optional @param expand [Array(String)?] Specifies which fields in the response should be expanded.
    # @return nil
    def post_checkout_sessions_session_expire(
      *,
      session : String? = nil,
      expand : Array(String)? = nil,
      &block : Crest::Response ->
    ) : Nil
      build_api_request_for_post_checkout_sessions_session_expire(session: session, expand: expand).execute(&block)
    end

    POST_CHECKOUT_SESSIONS_SESSION_EXPIRE_MAX_LENGTH_FOR_SESSION = 5000

    # @return Crest::Request
    def build_api_request_for_post_checkout_sessions_session_expire(
      *,
      session : String? = nil,
      expand : Array(String)? = nil
    ) : Crest::Request
      if debugging?
        Log.debug { "Calling API: CheckoutApi.post_checkout_sessions_session_expire ..." }
      end

      if client_side_validation?
        raise ArgumentError.new("\"session\" is required and cannot be null") if session.nil?
        unless (_session = session).nil?
          OpenApi::PrimitiveValidator.validate_max_length("session", session.to_s.size, POST_CHECKOUT_SESSIONS_SESSION_EXPIRE_MAX_LENGTH_FOR_SESSION)
        end
      end

      # resource path
      local_var_path = "/v1/checkout/sessions/{session}/expire".sub("{" + "session" + "}", URI.encode_path(session.to_s))

      # header parameters
      header_params : Hash(String, String) = Hash(String, String).new
      # HTTP header "Accept" (if needed)
      header_params["Accept"] = @api_client.select_header_accept(["application/json"])
      # HTTP header "Content-Type"
      header_params["Content-Type"] = @api_client.select_header_content_type(["application/x-www-form-urlencoded"])

      # cookie parameters
      cookie_params : Hash(String, String) = Hash(String, String).new

      # query parameters
      query_params : Hash(String, (String | Array(String) | JSON::Any)) = Hash(String, (String | Array(String) | JSON::Any)).new

      # form parameters
      form_params : Array(Tuple(String, Crest::ParamsValue)) | Nil = Array(Tuple(String, Crest::ParamsValue)).new
      form_params.concat(Crest::ZeroEnumeratedFlatParamsEncoder.flatten_params(JSON.parse(expand.to_json), "expand")) if !expand.nil?

      # http body (model)
      post_body : IO | String | Nil = nil

      # auth_names
      auth_names = ["basicAuth", "bearerAuth"]

      @api_client.build_api_request(
        http_method: :"POST",
        path: local_var_path,
        operation: "CheckoutApi.post_checkout_sessions_session_expire",
        post_body: post_body,
        auth_names: auth_names,
        header_params: header_params,
        cookie_params: cookie_params,
        query_params: query_params,
        form_params: form_params
      )
    end
  end
end
